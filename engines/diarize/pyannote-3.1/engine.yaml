id: pyannote-3.1
stage: diarize
name: Pyannote Speaker Diarization 3.1
version: 1.0.0
description: |
  Speaker diarization using pyannote-audio 3.1.
  Identifies who speaks when in an audio file.

  Requires HuggingFace token (HF_TOKEN) for accessing gated models.
  Supports optional min/max speaker count hints for improved accuracy.

container:
  gpu: optional  # Recommended for performance; very slow on CPU
  memory: 6G
  model_cache: /models

capabilities:
  languages:
    - all  # Language-agnostic speaker diarization
  max_audio_duration: 7200  # 2 hours
  streaming: false

input:
  audio_formats:
    - wav
  sample_rate: 16000
  channels: 1

config_schema:
  type: object
  properties:
    min_speakers:
      type: integer
      minimum: 1
      description: Minimum number of speakers (hint for clustering)
    max_speakers:
      type: integer
      minimum: 1
      description: Maximum number of speakers (hint for clustering)
  additionalProperties: false

output_schema:
  type: object
  required:
    - speakers
    - diarization_segments
  properties:
    speakers:
      type: array
      description: List of detected speaker IDs
      items:
        type: string
    diarization_segments:
      type: array
      description: Speaker turns with timestamps
      items:
        type: object
        required:
          - start
          - end
          - speaker
        properties:
          start:
            type: number
            description: Segment start time in seconds
          end:
            type: number
            description: Segment end time in seconds
          speaker:
            type: string
            description: Speaker ID (e.g., "SPEAKER_00")
